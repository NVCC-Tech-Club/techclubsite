{"ast":null,"code":"import { combine, fromOrdinal, sort } from '../dateutil';\nimport { pymod, isPresent, includes } from '../helpers';\nexport function buildPoslist(bysetpos, timeset, start, end, ii, dayset) {\n  var poslist = [];\n  for (var j = 0; j < bysetpos.length; j++) {\n    var daypos = void 0;\n    var timepos = void 0;\n    var pos = bysetpos[j];\n    if (pos < 0) {\n      daypos = Math.floor(pos / timeset.length);\n      timepos = pymod(pos, timeset.length);\n    } else {\n      daypos = Math.floor((pos - 1) / timeset.length);\n      timepos = pymod(pos - 1, timeset.length);\n    }\n    var tmp = [];\n    for (var k = start; k < end; k++) {\n      var val = dayset[k];\n      if (!isPresent(val)) continue;\n      tmp.push(val);\n    }\n    var i = void 0;\n    if (daypos < 0) {\n      i = tmp.slice(daypos)[0];\n    } else {\n      i = tmp[daypos];\n    }\n    var time = timeset[timepos];\n    var date = fromOrdinal(ii.yearordinal + i);\n    var res = combine(date, time);\n    // XXX: can this ever be in the array?\n    // - compare the actual date instead?\n    if (!includes(poslist, res)) poslist.push(res);\n  }\n  sort(poslist);\n  return poslist;\n}","map":{"version":3,"names":["combine","fromOrdinal","sort","pymod","isPresent","includes","buildPoslist","bysetpos","timeset","start","end","ii","dayset","poslist","j","length","daypos","timepos","pos","Math","floor","tmp","k","val","push","i","slice","time","date","yearordinal","res"],"sources":["../../../src/iter/poslist.ts"],"sourcesContent":[null],"mappings":"AAAA,SAASA,OAAO,EAAEC,WAAW,EAAEC,IAAI,QAAQ,aAAa;AAExD,SAASC,KAAK,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,YAAY;AAGvD,OAAM,SAAUC,YAAYA,CAC1BC,QAAkB,EAClBC,OAAe,EACfC,KAAa,EACbC,GAAW,EACXC,EAAY,EACZC,MAAyB;EAEzB,IAAMC,OAAO,GAAW,EAAE;EAE1B,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGP,QAAQ,CAACQ,MAAM,EAAED,CAAC,EAAE,EAAE;IACxC,IAAIE,MAAM,SAAQ;IAClB,IAAIC,OAAO,SAAQ;IACnB,IAAMC,GAAG,GAAGX,QAAQ,CAACO,CAAC,CAAC;IAEvB,IAAII,GAAG,GAAG,CAAC,EAAE;MACXF,MAAM,GAAGG,IAAI,CAACC,KAAK,CAACF,GAAG,GAAGV,OAAO,CAACO,MAAM,CAAC;MACzCE,OAAO,GAAGd,KAAK,CAACe,GAAG,EAAEV,OAAO,CAACO,MAAM,CAAC;KACrC,MAAM;MACLC,MAAM,GAAGG,IAAI,CAACC,KAAK,CAAC,CAACF,GAAG,GAAG,CAAC,IAAIV,OAAO,CAACO,MAAM,CAAC;MAC/CE,OAAO,GAAGd,KAAK,CAACe,GAAG,GAAG,CAAC,EAAEV,OAAO,CAACO,MAAM,CAAC;;IAG1C,IAAMM,GAAG,GAAG,EAAE;IACd,KAAK,IAAIC,CAAC,GAAGb,KAAK,EAAEa,CAAC,GAAGZ,GAAG,EAAEY,CAAC,EAAE,EAAE;MAChC,IAAMC,GAAG,GAAGX,MAAM,CAACU,CAAC,CAAC;MACrB,IAAI,CAAClB,SAAS,CAACmB,GAAG,CAAC,EAAE;MACrBF,GAAG,CAACG,IAAI,CAACD,GAAG,CAAC;;IAEf,IAAIE,CAAC,SAAQ;IACb,IAAIT,MAAM,GAAG,CAAC,EAAE;MACdS,CAAC,GAAGJ,GAAG,CAACK,KAAK,CAACV,MAAM,CAAC,CAAC,CAAC,CAAC;KACzB,MAAM;MACLS,CAAC,GAAGJ,GAAG,CAACL,MAAM,CAAC;;IAGjB,IAAMW,IAAI,GAAGnB,OAAO,CAACS,OAAO,CAAC;IAC7B,IAAMW,IAAI,GAAG3B,WAAW,CAACU,EAAE,CAACkB,WAAW,GAAGJ,CAAC,CAAC;IAC5C,IAAMK,GAAG,GAAG9B,OAAO,CAAC4B,IAAI,EAAED,IAAI,CAAC;IAC/B;IACA;IACA,IAAI,CAACtB,QAAQ,CAACQ,OAAO,EAAEiB,GAAG,CAAC,EAAEjB,OAAO,CAACW,IAAI,CAACM,GAAG,CAAC;;EAGhD5B,IAAI,CAACW,OAAO,CAAC;EAEb,OAAOA,OAAO;AAChB"},"metadata":{},"sourceType":"module","externalDependencies":[]}